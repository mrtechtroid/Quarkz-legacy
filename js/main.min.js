import{initializeApp}from"https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";import{getAuth,onAuthStateChanged,setPersistence,browserLocalPersistence,GoogleAuthProvider,signInWithPopup,signOut,createUserWithEmailAndPassword,signInWithEmailAndPassword,sendPasswordResetEmail}from"https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js";import{getFirestore,orderBy,limit,writeBatch,collection,addDoc,onSnapshot,arrayUnion,arrayRemove,setDoc,updateDoc,getDocs,doc,serverTimestamp,getDoc,query,where}from"https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore.js";import{getStorage,ref,uploadBytesResumable,getDownloadURL}from"https://www.gstatic.com/firebasejs/9.6.0/firebase-storage.js";import{sysaccess}from"/js/reworkui.js";const firebaseConfig={apiKey:"AIzaSyDN8T7Pmw5e-LzmC3nAHEqI0Uk7FF7y6fc",authDomain:"quarkz.firebaseapp.com",projectId:"quarkz",storageBucket:"quarkz.appspot.com",messagingSenderId:"1050835442263",appId:"1:1050835442263:web:e7d05ca9373f2f6083a112",measurementId:"G-1Y3S45VWFH"},app=initializeApp(firebaseConfig),db=getFirestore(),auth=getAuth();setPersistence(auth,browserLocalPersistence).then(()=>signInWithEmailAndPassword(auth,email,password)).catch(error=>{});const storage=getStorage();function sd(seconds){seconds=Number(seconds);var d=Math.floor(seconds/86400),h=Math.floor(seconds%86400/3600),m=Math.floor(seconds%3600/60),s=Math.floor(seconds%60),dDisplay,hDisplay,mDisplay,sDisplay;return(d>0?d+(1==d?" day, ":" days, "):"")+(h>0?h+(1==h?" hour, ":" hours, "):"")+(m>0?m+(1==m?" minute, ":" minutes, "):"")+(s>0?s+(1==s?" second":" seconds"):"")}function makeid(length){for(var result="",characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",charactersLength=characters.length,i=0;i<length;i++)result+=characters.charAt(Math.floor(Math.random()*charactersLength));return result}async function sha256(message){const msgBuffer=(new TextEncoder).encode(message),hashBuffer=await crypto.subtle.digest("SHA-256",msgBuffer),hashArray=Array.from(new Uint8Array(hashBuffer)),hashHex=hashArray.map(b=>b.toString(16).padStart(2,"0")).join("");return hashHex}function areEqual(arr1,arr2){let N=arr1.length,M;if(N!=arr2.length)return!1;arr1.sort(),arr2.sort();for(let i=0;i<N;i++)if(arr1[i]!=arr2[i])return!1;return!0}function mobileCheck(){let check=!1;var a;return a=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(check=!0),check}function areObjectsEqual(x,y){const ok=Object.keys,tx=typeof x,ty=typeof y;return x&&y&&"object"===tx&&tx===ty?ok(x).length===ok(y).length&&ok(x).every(key=>areObjectsEqual(x[key],y[key])):x===y}function getServerTime(url){fetch(url).then(response=>{var date;for(var pair of response.headers.entries())"date"===pair[0]&&(date=new Date(pair[1]).getTime());return date})}function fullEle(ele){ele.requestFullscreen?ele.requestFullscreen():ele.mozRequestFullScreen?ele.mozRequestFullScreen():ele.webkitRequestFullscreen?ele.webkitRequestFullscreen():ele.msRequestFullscreen&&ele.msRequestFullscreen()}function dE(ele){return document.getElementById(ele)}function sortObj(objs,param,type){var sorter2;return 0==type&&(sorter2=sortBy=>(a,b)=>a[sortBy]>b[sortBy]?1:-1),1==type&&(sorter2=sortBy=>(a,b)=>a[sortBy]>b[sortBy]?-1:1),console.log(objs.sort(sorter2(param))),objs.sort(sorter2(param))}function renderMarkedMath(eleid,toid){var v=marked.parse(dE(eleid).value);dE(toid).innerHTML=v,renderMathInElement(dE(toid))}function log(title,msg,action,actionname){dE("msg_popup").style.visibility="visible",dE("msg_popup").style.opacity="1",dE("msg_action").style.display="none",document.getElementById("msg_popup_txt").innerText=title,document.getElementById("msg_popup_content").innerText=msg,null==action?action=function(){}:dE("msg_action").style.display="block",null==actionname&&(actionname=""),dE("msg_action").onclick=action,dE("msg_action").innerText=actionname}function t_log(title,msg,action,actionname){dE("t1_msg_popup").style.visibility="visible",dE("t1_msg_popup").style.opacity="1",dE("t1_msg_action").style.display="none",document.getElementById("t1_msg_popup_txt").innerText=title,document.getElementById("t1_msg_popup_content").innerText=msg,null==action?action=function(){}:dE("msg_action").style.display="block",null==actionname&&(actionname=""),dE("t1_msg_action").onclick=action,dE("t1_msg_action").innerText=actionname}const mergeById=(a1,a2)=>a1.map(itm=>({...a2.find(item=>item.qid===itm.qid&&item),...itm}));function gST(){return getServerTime("https:/quarkz.netlify.app/time")}let mediaRecorder,recentMessagesQuery;async function recordScreen(){return await navigator.mediaDevices.getDisplayMedia({audio:!0,video:{mediaSource:"screen"}})}function createRecorder(stream,mimeType){let recordedChunks=[];const mediaRecorder=new MediaRecorder(stream);return mediaRecorder.ondataavailable=function(e){e.data.size>0&&recordedChunks.push(e.data)},mediaRecorder.onstop=function(){saveFile(recordedChunks),recordedChunks=[]},mediaRecorder.start(200),mediaRecorder}function saveFile(recordedChunks){const blob=new Blob(recordedChunks,{type:"video/webm"});let filename=window.prompt("Enter file name"),downloadLink=document.createElement("a");downloadLink.href=URL.createObjectURL(blob),downloadLink.download=`${filename}.webm`,document.body.appendChild(downloadLink),downloadLink.click(),URL.revokeObjectURL(blob),document.body.removeChild(downloadLink)}async function signIn(){var email=dE("lg_uname").value,password=dE("lg_pass").value;signInWithEmailAndPassword(auth,email,password).then(userCredential=>{const user=userCredential.user;userdetails.email=email,locationHandler("dashboard",1),dE("lg_uname").value="",dE("lg_pass").value="",spoints.style.display="block",dE("dsh_btn").style.display="block"}).catch(error=>{const errorCode=error.code,errorMessage=error.message;dE("lgn_err").style.display="block",dE("lg_pass").value=""})}function signOutUser(){signOut(getAuth()),userdetails=[]}function signUp(){var email=dE("rg_uname").value,password=dE("rg_pass").value,name=dE("rg_name").value,mblno=dE("rg_mbleno").value,stclass=dE("rg_class").value,stgender=dE("rg_gender").value;""!=email&&""!=password&&""!=name&&""!=mblno&&""!=stclass||alert("Details Cannot Be Empty"),password!=dE("rg_pass1").value||createUserWithEmailAndPassword(auth,email,password).then(userCredential=>{const user=userCredential.user;async function a(){try{await setDoc(doc(db,"users",user.uid),{name:name,class:stclass,mblno:mblno,email:email,spoints:0,gen:stgender,sgndon:serverTimestamp(),roles:{user:!0}}).then((function(){window.location.reload()}))}catch(error){console.error("Error Adding New User",error)}}a()}).catch(error=>{const errorCode=error.code,errorMessage=error.message})}function locationHandler(newlocation,n1){var iorole=1==adminrole||1==editorrole;switch(iorole?(dE("adminonly").style.display="flex",dE("tp_pnt").style.display="block",dE("tp_edt").style.display="block",dE("sms_edit").style.display="block"):(dE("adminonly").style.display="none",dE("sms_edit").style.display="none"),dE(handlebox).classList.remove("_open"),1==n1&&(window.location.hash="#/"+newlocation),handlebox=newlocation,location1=window.location.hash.split("#/")[1]){case"profile":handlebox="profile";break;case"about":handlebox="aboutus";break;case"login":handlebox="login";break;case"dashboard":handlebox="dashboard";break;case"timetable":handlebox="schedule";break;case"logout":signOut();break;case"mainsformulas":handlebox="mainsformulas",renderDownloadPage(1);break;case"downloads":handlebox="downloads",renderDownloadPage(2);break;case"livequiz":handlebox="livequiz";break;case"register":handlebox="register";break;case"testinfo":handlebox="testinfo",renderTestList("active");break;case"legal":handlebox="legal";break;case"appinfo":handlebox="appinfo",renderAppInfo();break;case"forum":handlebox="forum";break;case"testing":handlebox="testing";break;case"bugreport":handlebox="bugreport";break;case"simlist":handlebox="simlist",getSimList();break;case"testend":handlebox="test_end";break;case"add/question":handlebox="fu_question";break;case"add/lesson":handlebox="fu_lesson",newLesson();break;case"add/tpc":handlebox="fu_topic",newTopic();break;case"add/images":handlebox="fu_images";break;case"add/qubank":handlebox="fu_topic",newQBank();break;case"add/simulation":handlebox="fu_simulation",newSimulation();break;case"add/tests":handlebox="fu_topic",newTest();break;case"chplist":handlebox="chapterlist",renderCList();break;default:handlebox="error_page"}location1.includes("instructions")&&(handlebox="test_instructions"),location1.includes("cyberhunt")&&(handlebox="cyberhunt",getCyberhunt()),location1.includes("notes")&&!location1.includes("usernotes")&&(handlebox="notes",getPDF()),location1.includes("sims")&&(handlebox="simulations",getSimulation()),location1.includes("chapter")&&(handlebox="chapter",getChapterEList()),location1.includes("qbanks")&&(handlebox="topic",getTopic(2)),location1.includes("usernotes")&&(handlebox="usernotes",getUserNotes()),location1.includes("qbnk_vid")&&(handlebox="qbnk_vid",dE("qbnk_vid_btn").style.display="block"),location1.includes("attempt")&&(handlebox="testv1",getTestInfo()),location1.includes("finished")&&(handlebox="finishedtestinfo",getSimpleTestReport()),location1.includes("testreport")&&(handlebox="testv1",getTestReport()),location1.includes("printable/qbank")&&1==iorole&&(handlebox="printable",printQBank(1)),location1.includes("ARIEL")&&1==iorole&&(handlebox="Ariel"),location1.includes("printable/tests")&&1==iorole&&(handlebox="printable",printQBank(3)),"functions"==location1&&1==iorole&&(handlebox="functions",changeItem()),location1.includes("users")&&1==iorole&&(handlebox="users",userUpdate()),location1.includes("topic")&&(handlebox="topic",getTopic(1)),location1.includes("printable/topic")&&1==iorole&&(handlebox="printable",printQBank(2)),location1.includes("livequiz")&&(handlebox="livequiz",lquizinit()),location1.includes("edit_sim")&&1==iorole&&(handlebox="fu_simulation",prepareSimulation()),location1.includes("edit_lesson")&&1==iorole&&(handlebox="fu_simulation",prepareLesson()),location1.includes("edit_tpc")&&1==iorole&&(handlebox="fu_topic",prepareTopicQBank(1)),location1.includes("edit_test")&&1==iorole&&(handlebox="fu_topic",prepareTopicQBank(3)),location1.includes("edit_qubank")&&1==iorole&&(handlebox="fu_topic",prepareTopicQBank(2)),location1.includes("edit_exams")&&1==iorole&&(handlebox="fu_topic",prepareTopicQBank(4)),0!=userrole&&null!=userrole&&null!=userrole||"login"==location1||"register"==location1||location1.includes("notes")||"legal"==location1||"about"==location1||"bugreport"==location1||"appinfo"==location1||"mainsformulas"==location1||"downloads"==location1||(handlebox="error_page"),dE(handlebox).classList.add("_open"),stpVid(),editqllist=[],"forum"==location1?gtMsg(1):(gtMsg(2),forum_length=1,forum_d="afterbegin")}async function newBatch(){try{const docRef=await addDoc(collection(db,"batch"),{name:"",timetable:"",crton:serverTimestamp(),class:0});locationHandler("edit_batch/"+docRef.id,1)}catch{}}async function prepareBatch(){}async function updateBatch(){}async function getBatch(){}async function unotes1(){await updateDoc(doc(db,"usernotes",window.location.hash.split("usernotes/")[1]),{title:dE("un_title").value,notes:getHTM("un_editable"),lastupdated:serverTimestamp(),type:dE("un_viewership").value})}function unotes2(){}async function getUserNotes(){dE("un_rendermode").value="edit";try{window.notesUIHandler()}catch{}if(window.location.hash.includes("usernotes/add")){var docRef=await addDoc(collection(db,"usernotes"),{title:"Notes Title",notes:"",uuid:userinfo.uuid,crton:serverTimestamp(),type:"private",lastupdated:serverTimestamp()});await updateDoc(doc(db,"users",userinfo.uuid),{usernotes:arrayUnion({color:"black",id:docRef.id,title:"Notes Title"})}),locationHandler("#/usernotes/"+docRef.id,1)}else if(window.location.hash.includes("usernotes/delete"))await deleteDoc(doc(db,"usernotes",window.location.hash.split("usernotes/delete/")[1]));else if("#/usernotes/"==window.location.hash);else{var docRef=doc(db,"usernotes",window.location.hash.split("usernotes/")[1]),docSnap=await getDoc(docRef);if(docSnap.exists()){var docRef=docSnap.data();dE("un_title").value=docRef.title,setHTM("un_editable",docRef.notes),dE("un_viewership").value=docRef.type}}}function uNotesClicker(){window.location.hash="#/usernotes/"+this.id.split("uno")[1]}async function getUserNotesList(){for(var i=0;i<userinfo.usernotes.length;i++)dE("un_list").insertAdjacentHTML("beforeend","<div class='t_notes' id='uno"+userinfo.usernotes[i].id+"' style='background-color: "+userinfo.usernotes[i].color+"'><span class='tntc2' id='"+userinfo.usernotes[i].id+"'>"+userinfo.usernotes[i].title+"</span></div>"),dE("uno"+userinfo.usernotes[i].id).addEventListener("click",uNotesClicker)}async function getPDF(){var id=window.location.hash.split("notes/")[1];getDownloadURL(ref(storage,"public/"+id+".pdf")).then(url=>{dE("nt_id").src=url+""}).catch(error=>{switch(error.code){case"storage/object-not-found":dE("nt_id").src="https://firebasestorage.googleapis.com/v0/b/quarkz.appspot.com/o/public%2F404.pdf?alt=media&token=8cc8f23a-6e24-41d6-984b-6d2cc9b89d11";break;case"storage/unauthorized":log("Unauthorised","You dont have necessary permissions to The file you requested.")}})}async function sndMsg(){var qtxt=dE("fm_message").value;if(qtxt.includes("/pinned")){qtxt=qtxt.split("/pinned")[1];try{await updateDoc(doc(db,"forum","pinned"),{message:qtxt})}catch{alert("You Dont Have The Privilages For This Command")}async function upDoc(sTime){await updateDoc(doc(db,"forum","ppinned"),{ppinned:arrayUnion({message:qtxt,user:userinfo.uuid,time:sTime})})}var sTime=await getServerTime("http://localhost:5500/time.html").then(upDoc(sTime))}else""!=qtxt&&null!=qtxt?(await addDoc(collection(db,"forum"),{name:userinfo.name,message:qtxt,userid:userinfo.uuid,sgndon:serverTimestamp()}),dE("fm_message").value=""):alert("Message Cannot Be Empty")}function displayMessage(id,time,name,text){var d="<div id = 'dM"+id+"'><span class = 'dmName'>"+name+": </span><span class = 'dmText'>"+text+"</span><span class = 'dmtime'>"+time+"</span></div>";dE("forum_live").insertAdjacentHTML(forum_d,d)}function deleteMessage(id){dE("dM"+id).remove()}let reMSG=function(){};async function gtMsg(type){1==type?(dE("forum_live").innerHTML="",recentMessagesQuery=query(collection(getFirestore(),"forum"),orderBy("sgndon","desc"),limit(10)),reMSG=onSnapshot(recentMessagesQuery,(function(snapshot){snapshot.docChanges().forEach((function(change){if("removed"===change.type)deleteMessage(change.doc.id);else if("added"==change.type){forum_length>=11&&(forum_d="beforeend");var message=change.doc.data();displayMessage(change.doc.id,"",message.name,message.message),forum_length+=1}}))}))):2==type&&(reMSG(),reMSG=function(){})}async function getPinned(){var docRef=doc(db,"forum","pinned"),docSnap=await getDoc(docRef);if(docSnap.exists()){var docRef=docSnap.data();dE("pinnedtxt").innerText=docRef.message}}var fmsend=dE("fm_send").addEventListener("click",sndMsg),forum_length=1,forum_d="afterbegin",testTimerfunction;function vidSlideController(docJSON){function iu(ele){ele.style.display="none"}function io(ele){ele.style.display="block"}function qif(ele){ele.style.display="flex"}var tpmcqcon=dE("tb_q_mcq_con"),tpmatrix=dE("tb_q_matrix"),tpanswer=dE("tb_q_answer");if(tpmcqcon.innerHTML="",dE("tb_q_qtext").innerHTML=docJSON.title+"<span class = 'sp_txt'>("+docJSON.type+")</span>","mcq"==docJSON.type||"mcq_multiple"==docJSON.type){qif(tpmcqcon),iu(tpmatrix),iu(tpanswer);var qop=docJSON.op,asi="";for(let ele1 of qop)asi+='<div class="tb_q_mcq_p rpl">'+ele1+"</div>";dE("tb_q_mcq_con").insertAdjacentHTML("beforeend",asi)}else if("matrix"==docJSON.type){iu(tpmcqcon),io(tpmatrix),iu(tpanswer);for(var qop1=docJSON.op1,qop2=docJSON.op2,qopn1=qop1.length,i=0;i<qopn1;i++)document.getElementsByClassName("tp_i1")[i].innerHTML=qop1[i];for(var i=0;i<qopn1;i++)document.getElementsByClassName("tp_i2")[i].innerHTML=qop2[i]}else if("numerical"==docJSON.type||"fill"==docJSON.type)iu(tpmcqcon),iu(tpmatrix),io(tpanswer);else if("taf"==docJSON.type){qif(tpmcqcon),iu(tpmatrix),iu(tpanswer);var asi='<div class="tp_mcq_p rpl">True</div><div class="tp_mcq_p rpl">False</div>';dE("tp_mcq_con").insertAdjacentHTML("beforeend",asi)}else iu(tpmcqcon),iu(tpmatrix),iu(tpanswer);renderMathInElement(dE("tp_ans_hold")),renderMathInElement(dE("tp_qtext"))}async function prepareVideo(){dE("qbnk_vid_btn").style.display="none",dE("qbnk_vid_btn_e").style.display="none";try{let docSnap=await getDoc(doc(db,"qbank",window.location.hash.split("qbnk_vid/")[1]));if(docSnap.exists()){var docJSON=docSnap.data();dE("tb_q_title").innerText=docJSON.name,dE("qb_vid_ti").innerText=docJSON.name,dE("qbnk_vid_q").style.display="none",dE("qbnk_vid_ans").style.display="none",dE("qbnk_vid_title").style.display="flex",dE("qbnk_vid_end").style.display="none",dE("watermark").style.display="none";let qllist=docJSON.qllist,stream=await recordScreen(),mimeType="video/mp4";fullEle(dE("qbnk_vid")),mediaRecorder=createRecorder(stream,mimeType);var ji=0,ti=0,jno=0,timer,iou=setInterval((function(){if(dE("qbnk_vid_q").style.display="none",dE("qbnk_vid_ans").style.display="none",dE("qbnk_vid_title").style.display="none",dE("qbnk_vid_end").style.display="none",0==ti)dE("qbnk_vid_title").style.display="flex",ti++;else if(jno==qllist.length-1)dE("qbnk_vid_end").style.display="flex",setTimeout((function(){mediaRecorder.stop(),dE("qbnk_vid_btn").style.display="block"}),5e3),clearInterval(iou);else if(0==ji||1==ji){vidSlideController(qllist[jno]);var f=jno+1;0==ji&&(dE("qbnk_timer").innerText=10,timer=setInterval((function(){dE("qbnk_timer").innerText=dE("qbnk_timer").innerText-1}),1e3)),dE("tb_q_qno").innerText="Question "+f+":",dE("qbnk_vid_q").style.display="flex",ji++}else if(2==ji){dE("qbnk_vid_ans").style.display="flex",clearInterval(timer);for(var asi="",i=0;i<qllist[jno].answer.length;i++)asi+='<div class="tb_q_mcq_p rpl" style = "background-color:green">'+qllist[jno].answer[i]+"</div>";dE("tb_q_ans").innerHTML=asi,dE("tb_q_hint").innerHTML=qllist[jno].hint,dE("tb_q_expl").innerHTML=qllist[jno].expl,ji=0,jno++}}),5e3)}}catch{}}async function getCyberhunt(){""==window.location.hash.split("/cyberhunt/")[1]||""==window.location.hash.split("/cyberhunt")[1]?(dE("cyb_code").style.display="flex",dE("cyb_viewer").style.display="none",dE("cyb_edit").style.display="none"):(dE("cyb_code").style.display="none",dE("cyb_viewer").style.display="flex",dE("cyb_edit").style.display="none")}async function newSimulation(){try{const docRef=await addDoc(collection(db,"sims"),{name:"",license:"",provider:"",url:""});locationHandler("edit_sim/"+docRef.id,1)}catch{}}async function prepareSimulation(){try{let docSnap=await getDoc(doc(db,"sims",window.location.hash.split("edit_sim/")[1]));if(docSnap.exists()){var docJSON=docSnap.data();dE("aq_simname").value=docJSON.name,dE("aq_simprov").value=docJSON.provider,dE("aq_simurl").value=docJSON.url,dE("aq_simlicense").value=docJSON.license,dE("aq_simsubj").value=docJSON.subject}}catch{}}async function updateSimulationWeb(){try{await updateDoc(doc(db,"sims",window.location.hash.split("edit_sim/")[1]),{name:dE("aq_simname").value,license:dE("aq_simlicense").value,provider:dE("aq_simprov").value,url:dE("aq_simurl").value,subject:dE("aq_simsubj").value});var subj=dE("aq_simsubj").value;"physics"==subj&&await updateDoc(doc(db,"sims","sims"),{physics:arrayUnion(dE("aq_simname").value)}),"chemistry"==subj&&await updateDoc(doc(db,"sims","sims"),{chemistry:arrayUnion(dE("aq_simname").value)}),"maths"==subj&&await updateDoc(doc(db,"sims","sims"),{maths:arrayUnion(dE("aq_simname").value)}),"computer"==subj&&await updateDoc(doc(db,"sims","sims"),{computer:arrayUnion(dE("aq_simname").value)}),"biology"==subj&&await updateDoc(doc(db,"sims","sims"),{biology:arrayUnion(dE("aq_simname").value)}),"statistics"==subj&&await updateDoc(doc(db,"sims","sims"),{statistics:arrayUnion(dE("aq_simname").value)}),"unfiled"==subj&&await updateDoc(doc(db,"sims","sims"),{unfiled:arrayUnion(dE("aq_simname").value)}),clearAQ()}catch(error){console.error("Error writing new message to Firebase Database",error)}}async function getSimulation(){var simid=window.location.hash.split("sims/")[1],docRef=doc(db,"sims",simid),docSnap=await getDoc(docRef);if(!docSnap.exists())throw locationHandler("error_page",1),new Error;var docJSON=docSnap.data();dE("sms_name").innerText=docJSON.name,dE("sms_prov").innerText=docJSON.provider,dE("sim_frame").src=docJSON.url}async function getSimID(sim_name){var docID;const q=query(collection(db,"sims"),where("name","==",sim_name)),querySnapshot=await getDocs(q);querySnapshot.forEach(doc=>{docID=doc.id}),locationHandler("sims/"+docID,1)}function simClicker(){getSimID(this.innerText)}async function getSimList(type){if(dE("sim_cont").innerHTML="",0==simlist.length){var docRef=doc(db,"sims","sims"),docSnap=await getDoc(docRef);if(!docSnap.exists())throw locationHandler("error_page",1),new Error;var docJSON=docSnap.data();simlist=docJSON}if("physics"==type)try{for(let ele of simlist.physics)""!=ele&&(dE("sim_cont").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:pink" id="sim'+btoa(ele)+'">'+ele+"</span>"),dE("sim"+btoa(ele)).addEventListener("click",simClicker))}catch{}if("chemistry"==type)try{for(let ele of simlist.chemistry)""!=ele&&(dE("sim_cont").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:crimson" id="sim'+btoa(ele)+'">'+ele+"</span>"),dE("sim"+btoa(ele)).addEventListener("click",simClicker))}catch{}if("maths"==type)try{for(let ele of simlist.maths)""!=ele&&(dE("sim_cont").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:turquoise" id="sim'+btoa(ele)+'">'+ele+"</span>"),dE("sim"+btoa(ele)).addEventListener("click",simClicker))}catch{}if("biology"==type)try{for(let ele of simlist.biology)""!=ele&&(dE("sim_cont").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:lime" id="sim'+btoa(ele)+'">'+ele+"</span>"),dE("sim"+btoa(ele)).addEventListener("click",simClicker))}catch{}if("computer"==type)try{for(let ele of simlist.computer)""!=ele&&(dE("sim_cont").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:violet" id="sim'+btoa(ele)+'">'+ele+"</span>"),dE("sim"+btoa(ele)).addEventListener("click",simClicker))}catch{}if("statistics"==type)try{for(let ele of simlist.statistics)""!=ele&&(dE("sim_cont").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:orange" id="sim'+btoa(ele)+'">'+ele+"</span>"),dE("sim"+btoa(ele)).addEventListener("click",simClicker))}catch{}if("unfiled"==type)try{for(let ele of simlist.unfiled)""!=ele&&(dE("sim_cont").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:white" id="sim'+btoa(ele)+'">'+ele+"</span>"),dE("sim"+btoa(ele)).addEventListener("click",simClicker))}catch{}}function addItemToQLLIst(){var qans=[dE("aq_answer").value],qtype=dE("aq_type").value,qop=[],qop1=[],qop2=[];if("mcq"==qtype||"mcq_multiple"==qtype)for(qans=[],i=0;i<document.getElementsByClassName("aq_mcq_ans").length;i++){var a=document.getElementsByClassName("aq_mcq_ans")[i].value;qans[i]=a}for(var i=0;i<document.getElementsByClassName("aq_mcq").length;i++)qop.push(document.getElementsByClassName("aq_mcq")[i].value);for(var i=0;i<document.getElementsByClassName("aq_i1").length;i++)qop1.push(document.getElementsByClassName("aq_i1")[i].value);for(var i=0;i<document.getElementsByClassName("aq_i2").length;i++)qop2.push(document.getElementsByClassName("aq_i2")[i].value);if(location1.includes("edit_test"))var json={qid:curr_qlid,mode:dE("aq_mode").value,title:getHTM("aq_qtext"),y_url:dE("aq_yurl").value,hint:dE("aq_hint").value,expl:getHTM("aq_expl"),type:qtype,answer:qans,op:qop,op1:qop1,op2:qop2,section:dE("aq_section").value};else if(location1.includes("edit_exams"))var json={id:curr_qlid,name:dE("aq_examname").value,date:dE("aq_examdate").value,info:dE("aq_examinfo").value,syllabus:dE("aq_examsyllabus").value,mode:"exams"};else var json={id:curr_qlid,mode:dE("aq_mode").value,title:getHTM("aq_qtext"),y_url:dE("aq_yurl").value,hint:dE("aq_hint").value,expl:getHTM("aq_expl"),type:qtype,answer:qans,op:qop,op1:qop1,op2:qop2,section:dE("aq_section").value};return json}async function changeItem(t){function iu(ele){ele.style.display="none"}function io(ele){ele.style.display="block"}function qif(ele){ele.style.display="flex"}var mode=dE("aq_mode").value,qcont=dE("aq_ans_hold"),qtype=dE("aq_type"),qans=dE("aq_answer"),qyurl=dE("aq_yurl"),qmcq=dE("aq_mcq_con"),qmat=dE("aq_matrix"),qimgupl=dE("aq_upl"),qqall=dE("aq_all"),qtpc=dE("aq_tpc"),qqbk=dE("aq_qbk"),qsims=dE("aq_sims");"question"==mode?(iu(qyurl),io(qcont),io(qtype),io(qans),qif(qqall)):"lesson"==mode?(io(qyurl),iu(qcont),iu(qtype),iu(qans),qif(qqall)):"exams"==mode&&(iu(qyurl),iu(qcont),iu(qtype),iu(qans),iu(qqall)),"mcq"==qtype.value||"mcq_multiple"==qtype.value?(qif(qmcq),iu(qmat),iu(qans)):"matrix"==qtype.value?(io(qmat),iu(qmcq),iu(qans)):(iu(qmat),iu(qmcq),io(qans))}function rEQL(u){renderEditQLList(this.innerText)}function renderEditQLList(qno){if("+"==qno){let po=editqllist.length;window.location.hash.includes("edit_exams")?editqllist[po]={id:Date.now()+Math.random().toString(36).substr(2),name:"",date:"",info:"",syllabus:"",mode:"exams"}:editqllist[po]={id:Date.now()+Math.random().toString(36).substr(2),mode:"",title:"",y_url:"",img:"",hint:"",expl:"",type:"mcq",answer:["1"],op:["1","2","3","4"],op1:[],op2:[],section:"Unfiled"},(window.location.hash.includes("edit_qubank")||window.location.hash.includes("edit_test"))&&(editqllist[po].mode="question"),location1.includes("edit_test")&&(editqllist[po].qid=editqllist[po].id),qno=po}dE("question_list").innerHTML="";for(var i=1;i<editqllist.length+1;i++)dE("question_list").insertAdjacentHTML("beforeend",'<span class = "t_no_qno" id = "t_no_qno_'+i+'">'+i+"</span>"),dE("t_no_qno_"+i).addEventListener("click",rEQL);dE("question_list").insertAdjacentHTML("beforeend",'<span class = "t_no_qno" id = "t_no_qno_add">+</span>'),dE("t_no_qno_add").addEventListener("click",rEQL),0!=qno&&(editqllist[curr_qlno-1]=addItemToQLLIst(),curr_qlno=qno);var op=editqllist[curr_qlno-1];if(window.location.href.includes("edit_exams"))return dE("aq_examname").value=op.name,dE("aq_examdate").value=op.date,dE("aq_examinfo").value=op.info,dE("aq_examsyllabus").value=op.syllabus,void changeItem();if(curr_qlid=location1.includes("edit_test")?op.qid:op.id,dE("aq_mode").value=op.mode,setHTM("aq_qtext",op.title),dE("aq_yurl").value=op.y_url,dE("aq_type").value=op.type,dE("aq_hint").value=op.hint,dE("aq_section").value=op.section,setHTM("aq_expl",op.expl),"mcq"==op.type||"mcq_multiple"==op.type){dE("aq_mcq_con").innerHTML="";for(var g=0;g<op.op.length;g++){addMCQ(),document.getElementsByClassName("aq_mcq")[g].value=op.op[g];for(var h=0;h<op.answer.length;h++)op.op[g]==op.answer[h]&&(document.getElementsByClassName("aq_mcq")[g].classList.add("aq_mcq_ans"),document.getElementsByClassName("aq_mcq_p")[g].style.borderColor="lime")}}else"numerical"!=op.type&&"explain"!=op.type&&"fill"!=op.type&&"taf"!=op.type||(dE("aq_answer").value=op.answer[0]);changeItem()}async function newTopic(){try{const docRef=await addDoc(collection(db,"topic"),{name:"",qllist:[],level:"jee",chid:"",chname:"",subject:""});locationHandler("edit_tpc/"+docRef.id,1)}catch{}}async function newQBank(){try{const docRef=await addDoc(collection(db,"qbank"),{name:"",qllist:[],level:"jee",chid:"",chname:"",subject:""});locationHandler("edit_qubank/"+docRef.id,1)}catch{}}async function prepareTopicQBank(iun){var col,id;1==iun?(col="topic",id=window.location.hash.split("edit_tpc/")[1],dE("fu_topic_title").innerText="Add/Edit Topic",dE("aq_mode").innerHTML='<option value="question">Question</option><option value="lesson">Lesson</option>',dE("aq_tpc_save").style.display="block",dE("aq_qbc_save").style.display="none",dE("aq_tst_save").style.display="none",dE("aq_test_extra").style.display="none",dE("aq_exam_save").style.display="none",dE("aq_exams").style.display="none",dE("aq_all").style.display="flex",dE("aq_ans_hold").style.display="flex"):2==iun?(col="qbank",id=window.location.hash.split("edit_qubank/")[1],dE("fu_topic_title").innerText="Add/Edit QBank",dE("aq_mode").innerHTML='<option value="question">Question</option>',dE("aq_tpc_save").style.display="none",dE("aq_tst_save").style.display="none",dE("aq_test_extra").style.display="none",dE("aq_qbc_save").style.display="block",dE("aq_exam_save").style.display="none",dE("aq_exams").style.display="none",dE("aq_all").style.display="flex",dE("aq_ans_hold").style.display="flex"):3==iun?(col="tests",id=window.location.hash.split("edit_tests/")[1],dE("fu_topic_title").innerText="Add/Edit Tests",dE("aq_mode").innerHTML='<option value="question">Question</option>',dE("aq_tpc_save").style.display="none",dE("aq_qbc_save").style.display="none",dE("aq_test_extra").style.display="flex",dE("aq_tst_save").style.display="block",dE("aq_exam_save").style.display="none",dE("aq_exams").style.display="none",dE("aq_all").style.display="flex",dE("aq_ans_hold").style.display="flex"):4==iun&&(col="quarkz",id="exams",dE("fu_topic_title").innerText="Add/Edit Exams",dE("aq_mode").innerHTML='<option value="exam">Exam</option>',dE("aq_tpc_save").style.display="none",dE("aq_qbc_save").style.display="none",dE("aq_test_extra").style.display="none",dE("aq_exam_save").style.display="block",dE("aq_tst_save").style.display="none",dE("aq_exams").style.display="flex",dE("aq_all").style.display="none",dE("aq_ans_hold").style.display="none");try{let docSnap=await getDoc(doc(db,col,id));if(docSnap.exists())if(1==iun||2==iun){var docJSON=docSnap.data();dE("aq_tpcname").value=docJSON.name,dE("aq_tpclevel").value=docJSON.level,dE("aq_tpc_subj").value=docJSON.subject,dE("aq_tpc_chapterid").value=docJSON.chid,editqllist=docJSON.qllist,renderEditQLList(0)}else if(3==iun){var docJSON=docSnap.data();function dateparser(var1){var now=new Date(var1);return now.setMinutes(now.getMinutes()-now.getTimezoneOffset()),now.toISOString().slice(0,16)}dE("aq_tpcname").value=docJSON.title,dE("aq_tpclevel").value=docJSON.level,dE("aq_tpc_subj").value=docJSON.subject,dE("aq_tst_batches").value=docJSON.batch.toString(),dE("aq_tst_stron").value=dateparser(1e3*docJSON.strton.seconds),dE("aq_tst_endon").value=dateparser(1e3*docJSON.endon.seconds),dE("aq_tst_timealotted").value=docJSON.timeallotted,dE("aq_tst_syllabi").value=docJSON.syllabus;let docSnap2=await getDoc(doc(db,"tests",id,"questions","questions")),docSnap3=await getDoc(doc(db,"tests",id,"questions","answers")),q=[],a=[];var docJSON2,docJSON3;if(docSnap2.exists())q=docSnap2.data().questions;if(docSnap3.exists())a=docSnap3.data().questions;editqllist=mergeById(q,a),renderEditQLList(0)}else if(4==iun){var docJSON=docSnap.data();editqllist=docJSON.examinfo,renderEditQLList(0)}}catch{}}function removeEntry(){for(var i=0;i<editqllist.length;i++)editqllist[i].qid!=curr_qlid&&editqllist.id!=curr_qlid||(editqllist.splice(i,1),renderEditQLList(0),null==(curr_qlid=editqllist[i-1].qid||editqllist[i-1].id)&&(curr_qlid=""))}async function updateTopicQBank(iun){for(var i=0;i<editqllist.length;i++)editqllist[i].qid!=curr_qlid&&editqllist.id!=curr_qlid||(editqllist[i]=addItemToQLLIst());var col,id;if(1==iun?(col="topic",id=window.location.hash.split("edit_tpc/")[1]):2==iun?(col="qbank",id=window.location.hash.split("edit_qubank/")[1]):3==iun?(col="tests",id=window.location.hash.split("edit_tests/")[1]):4==iun&&(col="quarkz",id="exams"),1==iun||2==iun)try{const docRef=await updateDoc(doc(db,col,id),{name:dE("aq_tpcname").value,qllist:editqllist,level:dE("aq_tpclevel").value,chid:dE("aq_tpc_chapterid").value,subject:dE("aq_tpc_subj").value})}catch{}else if(3==iun){try{var fgio=new Date(dE("aq_tst_stron").value),fgio2=new Date(dE("aq_tst_endon").value),wer=dE("aq_tst_batches").value.split(",");const docRef=await updateDoc(doc(db,col,id),{title:dE("aq_tpcname").value,timeallotted:dE("aq_tst_timealotted").value,syllabus:dE("aq_tst_syllabi").value,strton:fgio,endon:fgio2,batch:wer})}catch{}for(var q=[],a=[],i=0;i<editqllist.length;i++){var ele=editqllist[i];q.push({qid:ele.qid,mode:ele.mode,title:ele.title,type:ele.type,op:ele.op,op1:ele.op1,op2:ele.op2,section:ele.section}),a.push({qid:ele.qid,hint:ele.hint,expl:ele.expl,answer:ele.answer,section:ele.section})}try{const docRef=await updateDoc(doc(db,col,id,"questions","questions"),{questions:q})}catch(error){log(error)}try{const docRef=await updateDoc(doc(db,col,id,"questions","answers"),{questions:a})}catch{}}else if(4==iun){const docRef=await updateDoc(doc(db,col,id),{examinfo:editqllist})}}function qbkclicker(){window.location.hash="#/qbanks/"+atob(this.id.split("chpqbk")[1])}function tpcclicker(){window.location.hash="#/topic/"+atob(this.id.split("chptpc")[1])}async function getTopic(type){var fireID="",urlID="";1==type?(fireID="topic",urlID="topic"):2==type?(urlID="qbanks",fireID="qbank"):fireID="topic";var urlC=urlID+"/",topicno=window.location.hash.split(urlC)[1],docRef=doc(db,fireID,topicno),docSnap=await getDoc(docRef);if(!docSnap.exists())throw locationHandler("error_page",1),new Error;var docJSON=docSnap.data();(topicJSON={}).title=docJSON.name,topicJSON.qllist=docJSON.qllist,topicHandler(3)}async function getChapterEList(){dE("chp_chaptername").innerHTML="",dE("chp_qbk_list").innerHTML="",dE("chp_tpc_list").innerHTML="";var docRef=doc(db,"chapter",window.location.hash.split("#/chapter/")[1]),docSnap=await getDoc(docRef),iupa,docJSON,poll="";if(docSnap.exists()){var docJSON=docSnap.data();dE("chp_chaptername").innerText=docJSON.name;try{for(let ele of docJSON.qbanks)dE("chp_qbk_list").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:pink" id="chpqbk'+btoa(ele.id)+'">'+ele.title+"</span>"),dE("chpqbk"+btoa(ele.id)).addEventListener("click",qbkclicker)}catch{}try{for(let ele of docJSON.topics)dE("chp_tpc_list").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:pink" id="chptpc'+btoa(ele.id)+'">'+ele.title+"</span>"),dE("chptpc"+btoa(ele.id)).addEventListener("click",tpcclicker)}catch{}}}function chclicker(){window.location.hash="#/chapter/"+atob(this.id.split("qb")[1])}function renderCList(type){dE("qb_cont_2").innerHTML="";for(var i=0;i<chapterlist.length;i++){var ele=chapterlist[i];ele.subject==type&&(dE("qb_cont_2").insertAdjacentHTML("beforeend",'<span class="tlinks rpl" style = "color:pink" id="qb'+btoa(ele.id)+'">'+ele.name+"</span>"),dE("qb"+btoa(ele.id)).addEventListener("click",chclicker))}}async function printQBank(type){var fireID="";1==type?(fireID="qbank",dE("pe_tst_info").style.display="flex",dE("eqb_instr").style.display="none"):2==type?(fireID="topic",dE("pe_tst_info").style.display="none",dE("eqb_instr").style.display="none"):fireID=3==type?"tests":"qbank";var qbankno=window.location.hash.split("printable/"+fireID+"/")[1],qbanktitle=dE("qb_title"),docRef=doc(db,fireID,qbankno),docSnap=await getDoc(docRef),docJSON,qnos,qtitle,qtype,qimg;if(!docSnap.exists())throw locationHandler("error_page",1),new Error;qnos=(docJSON=docSnap.data()).qllist,qbanktitle.innerText=docJSON.name,dE("eqb_add").innerHTML="";for(let ele of qnos)if("question"==ele.mode){var docJSON;qtitle=(docJSON=ele).title,qtype=docJSON.type,null==(qimg=docJSON.img)&&(qimg="");var expl='<div class = "q_ans_expl" style = "font-weight:bold;color:green;font-size:10px;flex-direction:row;display:none;">Explaination:'+docJSON.expl+"</div>",ans="<div style = 'font-weight:bold;color:green;font-size:10px;flex-direction:row;display:none' class = 'q_ans_1'>Answer:",inhtml='<div class = "qbtp_q"><div id = "'+ele.id+'">'+qtitle+'<div class = "qb_q_ty">('+qtype+")</div></div>";if(dE("eqb_add").insertAdjacentHTML("beforeend",inhtml),""!=qimg){var iwo='<div class = "qb_img"><img src = "'+qimg+'"></div>';dE(ele.id).insertAdjacentHTML("beforeend",iwo)}var asi="";if("mcq"==qtype||"mcq_multiple"==qtype){var qop=docJSON.op;for(let ele1 of qop)asi+="<div class = 'qb_mcq_opt'>"+ele1+"</div>";var qrt='<div class = "qb_mcq_exp" type = "a">'+asi+"</div>";for(let ele1 of docJSON.answer)ans+="<div class = 'qb_mcq_ans'>"+ele1+"</div>"}if("taf"==qtype&&(qrt='<ol class = "qb_mcq_exp" type = "a"><li>True</li><li>False</li></ol>'),"explain"!=qtype&&"numerical"!=qtype&&"fill"!=qtype||(qrt=""),"matrix"==qtype){for(var qop1=docJSON.op1,qop2=docJSON.op2,qopn1=qop1.length,i=0;i<qopn1;i++)asi+="<tr><td>"+qop1[i]+"</td><td>"+qop2[i]+"</td>";qrt="<table>"+asi+"</table>"}dE(ele.id).insertAdjacentHTML("beforeend",qrt),dE(ele.id).insertAdjacentHTML("beforeend",ans+"</div>"),dE(ele.id).insertAdjacentHTML("beforeend",expl),renderMathInElement(dE("eqb_add"))}else if("lesson"==ele.mode){var docJSON;qtitle=(docJSON=ele).title,qtype=docJSON.type,qimg=docJSON.img;var inhtml='<div class = "les_q"><div id = "'+ele.id+'"><div style = "font-size:3vh;">'+qtitle+'</div><hr color="white" width="100%"></div>';dE("eqb_add").insertAdjacentHTML("beforeend",inhtml);var expl='<div class = "les_expl" style = "">'+docJSON.expl+'</div><hr color="white" width="100%">';dE(ele.id).insertAdjacentHTML("beforeend",expl),renderMathInElement(dE("eqb_add"))}dE("printable").insertAdjacentHTML("beforeend","<br></br>")}function renderDownloadPage(type){1==type?dE("mainsformulas").innerHTML='\n    <span style="font-size: 5vh;color:yellow" id="fm_title">Mains Formula Sheet</span>\n    <hr color="white" width="100%">\n    <div style="overflow-y: scroll;height:50vh;" class="flex_type">\n    <span class="tlinks rpl" onclick = "window.location.hash = \'/notes/PHYFORMULAS\'">Physics Formula Sheet</span>\n    <span class="tlinks rpl" onclick = "window.location.hash = \'/notes/MATHFORMULAS\'">Maths Formula Sheet</span>\n    </div>\n    <span style="font-size: 8px;">All PDF\'s Are Owned by their Respective Owners</span>\n    ':2==type&&(dE("downloads").innerHTML='\n    <span style="font-size: 5vh;color:yellow" id="fm_title">Downloads</span>\n    <hr color="white" width="100%">\n    <div style="overflow-y: scroll;height:50vh;" class="flex_type">\n      \n    </div>\n    ')}async function lessonRenderer(docJSON){dE("tp_question").style.display="none",dE("tp_lesson").style.display="block",loadVid(docJSON.y_url),dE("tp_lsno").innerText=docJSON.title,dE("tp_expl").innerHTML=docJSON.expl}async function questionRenderer(docJSON,type){function iu(ele){ele.style.display="none"}function io(ele){ele.style.display="block"}function qif(ele){ele.style.display="flex"}iu(dE("tp_hint")),iu(dE("tp_a_expl")),iu(dE("tp_e_answer")),iu(dE("tp_status"));var tpmcqcon=dE("tp_mcq_con"),tpmatrix=dE("tp_matrix"),tpanswer=dE("tp_answer");if(dE("tp_lsno").innerText="Question",dE("tp_question").style.display="flex",dE("tp_lesson").style.display="none",dE("tp_question").setAttribute("dataid",docJSON.id),dE("tp_question").setAttribute("qtype",docJSON.type),tpmcqcon.innerHTML="",dE("tp_qtext").innerHTML=docJSON.title,dE("tp_img").src="","mcq"==docJSON.type||"mcq_multiple"==docJSON.type){qif(tpmcqcon),iu(tpmatrix),iu(tpanswer);var qop=docJSON.op,asi="";for(let ele1 of qop)asi+='<div class="tp_mcq_p rpl" onclick = "mcqchose(this)">'+ele1+"</div>";dE("tp_mcq_con").insertAdjacentHTML("beforeend",asi)}else if("matrix"==docJSON.type){iu(tpmcqcon),io(tpmatrix),iu(tpanswer);for(var qop1=docJSON.op1,qop2=docJSON.op2,qopn1=qop1.length,i=0;i<qopn1;i++)document.getElementsByClassName("tp_i1")[i].innerText=qop1[i];for(var i=0;i<qopn1;i++)document.getElementsByClassName("tp_i2")[i].innerText=qop2[i]}else if("numerical"==docJSON.type||"fill"==docJSON.type)iu(tpmcqcon),iu(tpmatrix),io(tpanswer);else if("taf"==docJSON.type){qif(tpmcqcon),iu(tpmatrix),iu(tpanswer);var asi='<div class="tp_mcq_p rpl">True</div><div class="tp_mcq_p rpl">False</div>';dE("tp_mcq_con").insertAdjacentHTML("beforeend",asi)}else iu(tpmcqcon),iu(tpmatrix),iu(tpanswer);renderMathInElement(dE("tp_ans_hold")),renderMathInElement(dE("tp_qtext"))}async function topicHandler(type){var pol;pol=1==type?-1:1,topicJSONno<topicJSON.qllist.length&&2==type?topicJSONno+=pol:1==type&&topicJSONno>0&&(topicJSONno+=pol),3==type&&(topicJSONno=0);var a=topicJSON.title;dE("tp_title").innerText=a;var cddd=topicJSON.qllist[topicJSONno];"lesson"==cddd.mode?lessonRenderer(cddd):"question"==cddd.mode&&questionRenderer(cddd),stpVid()}function addMCQ(){var MCQ='<div class="aq_mcq_p" onclick="changeColor(this)"><input class="aq_mcq"></div>';dE("aq_mcq_con").insertAdjacentHTML("beforeend",MCQ)}function clearAQ(){setHTM("aq_qtext",""),setHTM("aq_expl",""),dE("aq_answer").value="",dE("aq_yurl").value="",dE("aq_hint").value="";for(var i=0;i<document.getElementsByClassName("aq_mcq").length;i++)document.getElementsByClassName("aq_mcq")[i].value="";for(var i=0;i<document.getElementsByClassName("aq_i1").length;i++)document.getElementsByClassName("aq_i1")[i].value="";for(var i=0;i<document.getElementsByClassName("aq_i2").length;i++)document.getElementsByClassName("aq_i2")[i].value=""}function removeMCQ(){document.getElementsByClassName("aq_mcq_p")[document.getElementsByClassName("aq_mcq").length-1].remove()}function initFirebaseAuth(){onAuthStateChanged(getAuth(),authStateObserver)}function shuffleQBank(){for(var ol=dE("eqb_add"),i=ol.children.length;i>=0;i--)ol.appendChild(ol.children[Math.random()*i|0])}function requestPasschange(){sendPasswordResetEmail(auth,userinfo.email).then(()=>{log("Success","Password Reset Email sent.")}).catch(error=>{const errorCode=error.code,errorMessage=error.message;log("Failure",errorMessage)})}async function authStateObserver(user){var upic=dE("prf_pphoto"),name=dE("prf_name"),phone=dE("prf_phone"),email=dE("prf_email"),stclass=dE("prf_class"),batch=dE("prf_batch"),gender=dE("prf_gender"),crton=dE("prf_crton"),tmtifr=dE("tmt_frame"),spoints=dE("spoints"),courseno,batchno,calenid;if(user){var docRef=doc(db,"users",user.uid),docSnap;if((docSnap=await getDoc(docRef)).exists()){var docJSON=docSnap.data();(userinfo=docJSON).uuid=user.uid,dE("dshd_uname").innerText=docJSON.email,dE("dshd_name").innerText=docJSON.name,name.textContent=docJSON.name,phone.textContent=docJSON.mblno,email.textContent=docJSON.email,stclass.textContent=docJSON.class,crton.textContent=new Date(1e3*docJSON.sgndon.seconds),gender.textContent=docJSON.gen,batchno=docJSON.batch,courseno=docJSON.course,spoints.textContent=docJSON.spoints,userrole=docJSON.roles.user,editorrole=docJSON.roles.editor,adminrole=docJSON.roles.admin,userinfo.usernotes=docJSON.usernotes}1==docJSON.deleted&&(log("Warning","User Account Has Been Deleted"),signOutUser()),"Male"==docJSON.gen?dE("prf_tab_img").src="/assets/q_male.svg":"Female"==docJSON.gen&&(dE("prf_tab_img").src="/assets/q_female.svg");try{var docRef=doc(db,"batch",batchno),docSnap;if((docSnap=await getDoc(docRef)).exists()){var docJSON=docSnap.data();batch.textContent=docJSON.name,dE("dshd_batch").innerText=docJSON.name,calenid=docJSON.timetable,getTestList(batchno,user.uid);var iframeurl="https://calendar.google.com/calendar/embed??height=600&wkst=2&bgcolor=%23ffffff&ctz=Asia%2FKolkata&showTitle=0&showCalendars=0&showTabs=0&showPrint=0&showDate=1&src="+calenid+"%40group.calendar.google.com&amp;ctz=Asia%2FKolkata";if(tmtifr.src=iframeurl,docJSON.delon.seconds<=parseInt(Date.now()/1e3))throw log("Warning","This Batch Has Been Deleted"),signOutUser(),window.reload(),new Error("DENIED");for(var i=0;i<docJSON.chlist.length;i++)chapterlist.push({name:docJSON.chlist[i].name,id:docJSON.chlist[i].id,subject:docJSON.chlist[i].subject})}}catch{}spoints.style.display="block",dE("dsh_btn").style.display="block",""!=window.location.hash&&null!=window.location.hash&&null!=window.location.hash||(window.location.hash="#/dashboard",autosignin=1);var docRef=doc(db,"quarkz","exams"),docSnap;if((docSnap=await getDoc(docRef)).exists()){var docJSON=docSnap.data();dE("db_exam_list").innerHTML="";for(var i=0;i<docJSON.examinfo.length;i++){var f=docJSON.examinfo[i];dE("db_exam_list").insertAdjacentHTML("beforeend",'<div class = "tlinks_min rpl"><span style="font-size: 16px;" onclick = "examlog(\''+f.name+"','"+f.date+"','"+f.info+"','"+f.syllabus+"')\">"+f.name+"</span></div>")}}locationHandler(window.location.hash.split("#/")[1],1),getUserNotesList()}else name.textContent="",phone.textContent="",email.textContent="",stclass.textContent="",spoints.textContent="",spoints.style.display="none",dE("dsh_btn").style.display="none",dE("tp_pnt").style.display="none",dE("tp_edt").style.display="none",locationHandler("login",1),1==autosignin&&document.location.reload()}function uploadImages(){var a=serverTimestamp(),file=dE("aq_file"),filecontent,reader=new FileReader;reader.onload=function(){var text=reader.result;filecontent=text.replace("","");const storageRef=ref(storage,a);uploadBytes(storageRef,file).then(snapshot=>{})},reader.readAsText(file.files[0])}function signUpRestrict(){alert("The App Is Invite Only Registrations Are NOT Available Right Now")}function checkQuestion(){for(var qid=dE("tp_question").getAttribute("dataid"),type=dE("tp_question").getAttribute("qtype"),answer,crranswer,explanation,hint,status=0,i=0;i<topicJSON.qllist.length;i++)if(topicJSON.qllist[i].id==qid){crranswer=topicJSON.qllist[i].answer,explanation=topicJSON.qllist[i].expl,hint=topicJSON.qllist[i].hint;break}if("numerical"!=type&&"fill"!=type||(crranswer==(answer=dE("tp_answer").value)?(dE("tp_status").innerText="Correct Answer",status=1):(dE("tp_status").innerText="Wrong Answer",status=0)),"mcq"==type||"mcq_multiple"==type||"taf"==type){answer=[];for(var k=0;k<document.getElementsByClassName("tp_mcq_p").length;k++)document.getElementsByClassName("tp_mcq_p")[k].classList.contains("aq_mcq_ans")&&answer.push(document.getElementsByClassName("tp_mcq_p")[k].innerText);areEqual(answer,crranswer)?(dE("tp_status").innerText="Correct Answer",status=1):(dE("tp_status").innerText="Wrong Answer",status=0)}dE("tp_status").style.display="block",dE("tp_hint").style.display="block",dE("tp_a_expl").style.display="block",dE("tp_e_answer").style.display="block",dE("tp_a_expl").innerHTML=explanation,dE("tp_hint").innerHTML=hint,dE("tp_e_answer").innerHTML="Answer:"+crranswer}function printStuff(){window.location.hash.includes("topic")?changeLocationHash("printable/topic/"+window.location.hash.split("topic/")[1],1):window.location.hash.includes("qbanks")&&changeLocationHash("printable/qbank/"+window.location.hash.split("qbanks/")[1],1),window.location.hash.includes("edit_tpc/")?changeLocationHash("printable/topic/"+window.location.hash.split("edit_tpc/")[1],1):window.location.hash.includes("edit_qubank/")&&changeLocationHash("printable/qbank/"+window.location.hash.split("edit_qubank/")[1],1)}function editStuff(){window.location.hash.includes("topic")?changeLocationHash("edit_tpc/"+window.location.hash.split("topic/")[1],1):window.location.hash.includes("qbanks")&&changeLocationHash("edit_qubank/"+window.location.hash.split("qbanks/")[1],1)}function changeLocationHash(ele,v){window.location.hash="#/"+ele,"dashboard"==ele&&locationHandler("dashboard",1)}async function lquizinit(){lquizcode=location1.split("livequiz")[1];var docRef=doc(db,"livequiz",lquizcode),docSnap=await getDoc(docRef);if(!docSnap.exists())throw new Error;var docJSON=docSnap.data()}async function getTestList(batchid,userid){if(testList!=[]){var docRef=doc(db,"batch",batchid,"info","tests"),docSnap=await getDoc(docRef);if(docSnap.exists()){var docJSON=docSnap.data();testList=docJSON.tests}}if(finishedTestList!=[]){const q=query(collection(db,"tests"),where("finished","array-contains",userid),limit(5)),querySnapshot=await getDocs(q);querySnapshot.forEach(doc=>{var min=doc.data(),docJSON={title:min.title,testid:doc.id,finished:!0,strton:min.strton,endon:min.endon};finishedTestList.push(docJSON);var a=0;for(let ele of testList)ele.testid==docJSON.testid?testList[a].finished=!0:testList[a].finished=!1,a+=1})}for(var localtime=parseInt(Date.now()/1e3),d=0;d<testList.length;d++)localtime>testList[d].strton.seconds&&localtime<testList[d].endon.seconds?activeTestList.push(testList[d]):localtime<testList[d].strton.seconds&&upcomingTestList.push(testList[d])}function testClicker(){window.location.hash="#/instructions/"+this.id}function finishedtestClicker(){window.location.hash="#/finished/"+this.id}async function newTest(){try{const docRef=await addDoc(collection(db,"tests"),{title:"",totalmarks:0,timeallotted:0,syllabus:"",strton:serverTimestamp(),endon:serverTimestamp(),questionnos:0,finished:[],batch:[]});var docRef1=await setDoc(doc(db,"tests",docRef.id,"questions","questions"),{questions:[]}),docRef2=await setDoc(doc(db,"tests",docRef.id,"questions","answers"),{questions:[]}),docRef4=await setDoc(doc(db,"tests",docRef.id,"responses","finished"),{finished:[],leaderboard:[]});locationHandler("edit_tests/"+docRef.id,1)}catch{}}function renderTestList(type){var renList;for(var ele of("active"==type?renList=activeTestList:"upcoming"==type?renList=upcomingTestList:"finished"==type&&(renList=finishedTestList),dE("testlinks").innerHTML="",renList)){var strson=new Date(1e3*ele.strton.seconds),endson=new Date(1e3*ele.endon.seconds),output='<div class="tlinks" id = "'+ele.testid+'"><span class = "t_title">'+ele.title+'</span><span class = "t_stron">Starts At:'+strson+'</span><span class ="t_endon">Ends At:'+endson+"</div>";"finished"!=type&&0==ele.finished?(dE("testlinks").insertAdjacentHTML("beforeend",output),dE(ele.testid).addEventListener("click",testClicker)):"finished"==type&&(dE("testlinks").insertAdjacentHTML("beforeend",output),dE(ele.testid).addEventListener("click",finishedtestClicker))}}async function getSimpleTestReport(){var testid=window.location.hash.split("#/finished/")[1],docRef=doc(db,"tests",testid),docSnap=await getDoc(docRef);if(docSnap.exists()){testInfo=docSnap.data();var attempted=0;if(dE("fti_title").innerText=testInfo.title,docRef=doc(db,"tests",testid,"responses","finished"),(docSnap=await getDoc(docRef)).exists())for(var ele of docSnap.data().finished)if(auth.currentUser.uid==ele){attempted=1;break}if(0==attempted)locationHandler("testend",1),dE("te_title").innerText="You Have NOT Attempted This Test";else try{try{computeResult(1)}catch{}try{docRef=doc(db,"tests",testid,"responses",auth.currentUser.uid);var tT=(docSnap=await getDoc(docRef)).data();if(docSnap.exists()){function r(t,c,ic,un,tm){var z=tm-(c-4*ic),gf;return"<div><span>"+t+"("+(c+ic)+' Marks)</span><div style = "width:40vw;height:30px;display:flex;flex-direction:row;"><div style="width:'+c/tm*40+'vw;background-color:green;height:30px;text-align:center;color:white">'+c+"/"+tm+'</div><div style="width:'+Math.abs(4*ic/tm*40)+'vw;background-color:red;height:30px;text-align:center;color:white">'+ic+"/"+tm+'</div><div style="width:'+40*(1-(c-4*ic)/tm)+'vw;background-color:orange;height:30px;text-align:center;color:black">'+z+"/"+tm+"</div></div></div>"}dE("fto_total").innerText=tT.info.usermarks+"/"+tT.info.total,dE("fto_correct").innerText=tT.info.correct,dE("fto_incorrect").innerText=tT.info.incorrect,dE("fto_unanswered").innerText=tT.info.unattempted,testActionLogger=tT.actions,reQW=tT.info.mList,dE("fto_rank").innerText="0";var ion1=["Physics","Chemistry","Math","Biology","Statistics","Computer","Unfiled"];for(var eleX of(dE("fto_percents").innerHTML="",ion1)){var el2e2=tT.info.subjectmarks[eleX];areObjectsEqual(el2e2,{correct:0,unattempted:0,incorrect:0,total:0})||dE("fto_percents").insertAdjacentHTML("beforeend",r(eleX,el2e2.correct,el2e2.incorrect,el2e2.unattempted,el2e2.total))}analyseActions(1).then((function(){function qw(t,c,ic,un,tm){var z=tm-(c+ic);return"<div><span>"+t+"("+sd(tm)+')</span><div style = "width:80vw;height:30px;display:flex;flex-direction:row;"><div style="width:'+c/tm*80+'vw;background-color:green;height:30px;text-align:center;color:white">'+sd(c)+'</div><div style="width:'+ic/tm*80+'vw;background-color:red;height:30px;text-align:center;color:white">'+sd(ic)+'</div><div style="width:'+80*(1-(c+ic)/tm)+'vw;background-color:orange;height:30px;text-align:center;color:black">'+sd(z)+"</div></div></div>"}var ion1=["Physics","Chemistry","Math","Biology","Statistics","Computer","Unfiled"];for(var eleX of(dE("fto_time").innerHTML="",ion1)){var eXZe2=analysedActions.subject[eleX];areObjectsEqual(eXZe2,{correct:0,unattempted:0,incorrect:0,total:0})||dE("fto_time").insertAdjacentHTML("beforeend",qw(eleX,eXZe2.correct,eXZe2.incorrect,eXZe2.unattempted,eXZe2.total))}}))}try{var leaderboard;docRef=doc(db,"tests",testid,"responses","finished"),(docSnap=await getDoc(docRef)).exists()&&(leaderboard=docSnap.data().leaderboard),dE("fto_leaderboard").innerHTML="",leaderboard=sortObj(leaderboard,"marks",1);for(var i=0;i<leaderboard.length;i++){var e=i+1;userinfo.uuid==leaderboard[i].uid&&(dE("fto_rank").innerText=e),dE("fto_leaderboard").insertAdjacentHTML("beforeend",'<div class = "tlinks" style = "flex-direction:row;width:25vw;justify-content:space-between;"><span class = "t_gre">&nbsp;'+e+'</span><span class = "t_name">'+leaderboard[i].name+'</span><span class = "t_gre">&nbsp;&nbsp;'+leaderboard[i].marks+"</span></div>")}}catch{}}catch{return dE("te_title").innerText="ERROR",locationHandler("testend",1),0}}catch{}}}async function analyseActions(typi){var tQList,tFinal;if(1==typi){var q=window.location.hash.split("/finished/")[1],docRef=doc(db,"tests",q,"questions","questions"),docSnap=await getDoc(docRef);docSnap.exists()&&(tQList=docSnap.data().questions)}else 2==typi&&(tQList=[],tQList=testQuestionList);for(var qnos={},i=0;i<testActionLogger.length;i++)testActionLogger[i].time=testActionLogger[i].time.seconds;for(var tAL=sortObj(testActionLogger,"time",0),curr_time,next_time,i=0;i<tAL.length;i++)"start"==tAL[i].type?curr_time=tAL[i].time:"change"==tAL[i].type&&(next_time=tAL[i].time,null==qnos[tAL[i].value]&&(qnos[tAL[i].value]={},qnos[tAL[i].value].time=0),qnos[tAL[i].value].time+=next_time-curr_time,curr_time=next_time,next_time=0);for(var subJTimes={Physics:{correct:0,unattempted:0,incorrect:0,total:0},Chemistry:{correct:0,unattempted:0,incorrect:0,total:0},Math:{correct:0,unattempted:0,incorrect:0,total:0},Biology:{correct:0,unattempted:0,incorrect:0,total:0},Computer:{correct:0,unattempted:0,incorrect:0,total:0},Statistics:{correct:0,unattempted:0,incorrect:0,total:0},Unfiled:{correct:0,unattempted:0,incorrect:0,total:0}},c=0,ic=0,un=0,i=0;i<tQList.length;i++)for(var j=0;j<reQW.length;j++)if(tQList[i].qid==reQW[j].qid){var ele=qnos[tQList[i].qid];null==qnos[tQList[i].qid]?(qnos[tQList[i].section]={},qnos[tQList[i].section].time=0):(subJTimes[tQList[i].section].total+=ele.time,0==reQW[i].marks?(subJTimes[tQList[i].section].unattempted+=ele.time,un+=ele.time):4==reQW[i].marks?(subJTimes[tQList[i].section].correct+=ele.time,c+=ele.time):(subJTimes[tQList[i].section].incorrect+=ele.time,ic+=ele.time))}analysedActions={questions:qnos,subject:subJTimes,correct:c,incorrect:ic,unattempted:un}}async function getTestReport(){dE("tt_footer").style.display="none",dE("tt_sub").style.display="none",dE("tt_timeleft").style.display="none",dE("tt_marksaward").style.display="block";var testid=window.location.hash.split("#/testreport/")[1],docRef=doc(db,"tests",testid),docSnap=await getDoc(docRef);if(docSnap.exists()){testInfo=docSnap.data();var attempted=0;if(dE("tt_testname").innerText=testInfo.title,docRef=doc(db,"tests",testid,"responses","finished"),(docSnap=await getDoc(docRef)).exists())for(var ele of docSnap.data().finished)if(auth.currentUser.uid==ele){attempted=1;break}if(0==attempted)locationHandler("testend",1),dE("te_title").innerText="You Have NOT Attempted This Test";else if(Date.now()/1e3<=testInfo.endon.seconds&&0==testInfo.noresult)locationHandler("testend",1),dE("te_title").innerText="Detailed Test Reports will be available after deadline";else{try{if(docRef=doc(db,"tests",testid,"questions","questions"),(docSnap=await getDoc(docRef)).exists()&&(testQuestionList=docSnap.data()),docRef=doc(db,"tests",testid,"responses",auth.currentUser.uid),(docSnap=await getDoc(docRef)).exists()){var yuta=docSnap.data().answers;for(var prop in testActionLogger=docSnap.data().actions,yuta)testResponseList.push({qid:prop,ans:yuta[prop].ans,type:yuta[prop].type,time:yuta[prop].time})}docRef=doc(db,"tests",testid,"questions","answers"),(docSnap=await getDoc(docRef)).exists()&&(testReportAnswers=docSnap.data())}catch{return dE("te_title").innerText="ERROR",locationHandler("testend",1),0}inittestHandler()}}}async function getTestInfo(){dE("tt_footer").style.display="flex",dE("tt_sub").style.display="block",dE("tt_timeleft").style.display="block",dE("tt_marksaward").style.display="none";var testid=window.location.hash.split("#/attempt/")[1],docRef=doc(db,"tests",testid),docSnap=await getDoc(docRef);if(docSnap.exists()&&(testInfo=docSnap.data(),docRef=doc(db,"tests",testid,"responses","finished"),(docSnap=await getDoc(docRef)).exists()))for(var ele of docSnap.data().finished)if(auth.currentUser.uid==ele)return locationHandler("testend",1),dE("te_title").innerText="You Have Already Attempted This Test",0;try{docRef=doc(db,"tests",testid,"questions","questions"),(docSnap=await getDoc(docRef)).exists()&&(testQuestionList=docSnap.data())}catch{return dE("te_title").innerText="The Test Hasnt Started Yet",locationHandler("testend",1),0}if(docRef=doc(db,"tests",testid,"responses",auth.currentUser.uid),(docSnap=await getDoc(docRef)).exists()){var yuta=docSnap.data().answers;for(var prop in testActionLogger=docSnap.data().actions,yuta)testResponseList.push({qid:prop,ans:yuta[prop].ans,type:yuta[prop].type,time:yuta[prop].time})}else{for(var trL={},t=0;t<testQuestionList.questions.length;t++)trL[`${testQuestionList.questions[t].qid}`]={type:"tts_notvisit",answer:[]},testResponseList.push({qid:testQuestionList.questions[t].qid,type:"tts_notvisit",answer:[]});var it=new Date;await setDoc(doc(db,"tests",testid,"responses",auth.currentUser.uid),{answers:trL,strton:serverTimestamp(),warning:[],actions:[{type:"start",time:it,value:"1"}]}),testActionLogger.push({type:"start",time:it,value:"1"})}window.location.hash.includes("/attempt/")&&(testTimerfunction=setInterval((function(){var seconds=testInfo.timeallotted-1;testInfo.timeallotted-=1,dE("tt_timeleft").innerText=Math.floor(seconds%86400/3600)+":"+Math.floor(seconds%3600/60)+":"+Math.floor(seconds%60),0==seconds&&submitTest()}),1e3)),window.onbeforeunload=function(e){e.preventDefault,submitTest()},window.onhashchange=function(e){locationHandler(),submitTest()},dE("tt_testname").innerText=testInfo.title,dE("dsh_btn").style.display="none",dE("tp_pnt").style.display="none",dE("tp_pnt").style.display="none";var tbox=dE("testv1");try{fullEle(tbox)}catch{}inittestHandler()}function tqH(){testqHandler(this.id,this.innerText)}async function computeResult(type){var trA,trL=[],marksList=[],fg=[],testid="";window.location.hash.includes("/attempt/")?(testid=window.location.hash.split("#/attempt/")[1],log("Warning","Submitting Tests Answers: Please Do Not Close The Tab.")):window.location.hash.includes("/finished/")?testid=window.location.hash.split("#/finished/")[1]:window.location.hash.includes("/testreport/")&&(testid=window.location.hash.split("#/testreport/")[1]);var docRef=doc(db,"tests",testid,"responses",auth.currentUser.uid),docSnap=await getDoc(docRef);if(docSnap.exists()){var yuta=docSnap.data().answers;for(var prop in fg=docSnap.data().info,yuta)trL.push({qid:prop,ans:yuta[prop].ans,type:yuta[prop].type,time:yuta[prop].time})}docRef=doc(db,"tests",testid,"questions","answers"),(docSnap=await getDoc(docRef)).exists()&&(trA=docSnap.data().questions);for(var u=0,c=0,ic=0,t=4*trA.length,subjectmarks={Physics:{correct:0,unattempted:0,incorrect:0,total:0},Chemistry:{correct:0,unattempted:0,incorrect:0,total:0},Math:{correct:0,unattempted:0,incorrect:0,total:0},Biology:{correct:0,unattempted:0,incorrect:0,total:0},Computer:{correct:0,unattempted:0,incorrect:0,total:0},Statistics:{correct:0,unattempted:0,incorrect:0,total:0},Unfiled:{correct:0,unattempted:0,incorrect:0,total:0}},i=0;i<trA.length;i++)for(var j=0;j<trL.length;j++)if(trA[i].qid==trL[j].qid){var ele=trL[j];null==ele.ans&&(ele.ans=[]),0==ele.ans.length?(marksList.push({qid:trA[i].qid,marks:0,type:"unattempted"}),u+=4,subjectmarks[trA[i].section].unattempted+=4,subjectmarks[trA[i].section].total+=4):areEqual(trA[i].answer,ele.ans)?(marksList.push({qid:trA[i].qid,marks:4,type:"correct"}),c+=4,subjectmarks[trA[i].section].correct+=4,subjectmarks[trA[i].section].total+=4):(marksList.push({qid:trA[i].qid,marks:-1,type:"incorrect"}),ic-=1,subjectmarks[trA[i].section].incorrect+=-1,subjectmarks[trA[i].section].total+=4)}var tFinal={correct:c,incorrect:ic,unattempted:u,mList:marksList,total:t,usermarks:c+ic,subjectmarks:subjectmarks};1==type?areObjectsEqual(tFinal,fg)||(log("NOTICE","Please Wait, Marks Are Being Updated"),await updateDoc(doc(db,"tests",testid,"responses",auth.currentUser.uid),{info:tFinal}),await updateDoc(doc(db,"tests",testid,"responses","finished"),{leaderboard:arrayUnion({uid:userinfo.uuid,marks:tFinal.usermarks,name:userinfo.name})}),locationHandler()):0==type&&(await updateDoc(doc(db,"tests",testid,"responses",auth.currentUser.uid),{info:tFinal}),await updateDoc(doc(db,"tests",testid,"responses","finished"),{leaderboard:arrayUnion({uid:userinfo.uuid,marks:tFinal.usermarks,name:userinfo.name})}),locationHandler("testend",1)),document.getElementById("msg_popup").style.visibility="hidden",document.getElementById("msg_popup").style.opacity="0"}function testqHandler(id,no){var MCQ="",TF='<div id = "tt_mcq"><span><input type="radio" value="a" class = "q_ans" name = "q_op">True</span><span><input type="radio" value="b" class = "q_ans" name = "q_op">False</span></div> ',MCQMULT="",NUM='<div id = "tt_num"><input type = "number" class="q_ans"></div>',FILL='<div id="tt_fill"><input type = "text" class = "q_ans"></div>',MATRIX='<div id = "tt_matrix"><div>A<span><input type="checkbox" value="a" id="q_ans_a" name = "q_op">1</span><span><input type="checkbox" value="b" id="q_ans_a" name = "q_op">2</span><span><input type="checkbox" value="c" id="q_ans_a" name = "q_op">3</span><span><input type="checkbox" value="d" id="q_ans_a" name = "q_op">4</span></div><div>B<span><input type="checkbox" value="a" id="q_ans_a" name = "q_op">1</span><span><input type="checkbox" value="b" id="q_ans_a" name = "q_op">2</span><span><input type="checkbox" value="c" id="q_ans_a" name = "q_op">3</span><span><input type="checkbox" value="d" id="q_ans_a" name = "q_op">4</span></div><div>C<span><input type="checkbox" value="a" id="q_ans_a" name = "q_op">1</span><span><input type="checkbox" value="b" id="q_ans_a" name = "q_op">2</span><span><input type="checkbox" value="c" id="q_ans_a" name = "q_op">3</span><span><input type="checkbox" value="d" id="q_ans_a" name = "q_op">4</span></div><div>D<span><input type="checkbox" value="a" id="q_ans_a" name = "q_op">1</span><span><input type="checkbox" value="b" id="q_ans_a" name = "q_op">2</span><span><input type="checkbox" value="c" id="q_ans_a" name = "q_op">3</span><span><input type="checkbox" value="d" id="q_ans_a" name = "q_op">4</span></div></div>',u=new Date;testActionLogger.push({type:"change",time:u,value:id}),dE("tt_qno").innerText=no,activequestionid=id;for(let ele of testQuestionList.questions)if(id==ele.qid){dE("tt_qtitle").innerHTML="";var inhtml='<div class = "qb_q" id = "Q'+ele.qid+'"><div class = "qb_ttl">'+ele.title+'<div id = "qb_q_ty" class = "qb_q_ty qb_qt_ty" >('+ele.type+")</div></div></div>";dE("tt_qtitle").insertAdjacentHTML("beforeend",inhtml);var asi="",ANS,tyio;if("mcq"==ele.type){var qop=ele.op;for(let ele1 of qop)asi+='<li><input type="radio" class = "q_ans" value = "'+ele1+'" name = "q_op">'+ele1+"</input></li>";var qrt='<ol class = "qb_mcq" type = "A">'+asi+"</ol>"}if("mcq_multiple"==ele.type){var qop=ele.op;for(let ele1 of qop)asi+='<li><input type="checkbox" class = "q_ans" value = "'+ele1+'" name = "q_op">'+ele1+"</input></li>";var qrt='<ol class = "qb_mcq" type = "A">'+asi+"</ol>"}if("taf"==ele.type&&(qrt='<ol class = "qb_mcq" type = "A"><li>True</li><li>False</li></ol>'),"explain"!=ele.type&&"numerical"!=ele.type||(qrt=""),"matrix"==ele.type){for(var qop1=ele.op1,qop2=ele.op2,qopn1=qop1.length,i=0;i<qopn1;i++)asi+="<tr><td>"+qop1[i]+"</td><td>"+qop2[i]+"</td>";qrt="<table>"+asi+"</table>"}switch(dE("tt_qtitle").insertAdjacentHTML("beforeend",qrt),ele.type){case"mcq":case"mcq_multiple":ANS="";break;case"taf":ANS=TF;break;case"numerical":ANS=NUM;break;case"matrix":ANS=MATRIX;break;case"fill":ANS=FILL}if(dE("tt_qtitle").insertAdjacentHTML("beforeend",ANS),!window.location.hash.includes("attempt"))for(let ele of testReportAnswers.questions)if(id==ele.qid){tyio=ele.answer,null!=analysedActions&&(dE("tt_timespent").innerText=sd(analysedActions.questions[ele.qid].time));var lio='<div id="tg_answer">Answer: '+ele.answer+'</div><div id="tg_expl">Explanation: '+ele.expl+"</div>";dE("tt_qtitle").insertAdjacentHTML("beforeend",lio)}renderMathInElement(dE("tt_qtitle"));var fghu=0;for(let ele23 of testResponseList)if(ele23.qid==id){for(var i=0;i<document.getElementsByClassName("q_ans").length;i++){var ele32=document.getElementsByClassName("q_ans")[i];if("mcq"==ele.type||"mcq_multiple"==ele.type){null==ele23.ans&&(ele23.ans=[]);for(let el433 of ele23.ans)if(ele32.value==el433){ele32.checked=!0,fghu=1;break}}else ele32.value=ele23.ans,fghu=1}window.location.hash.includes("attempt")||(areEqual(ele23.ans,tyio)?dE("tt_marksaward").innerHTML='<div style="color:lime">Correct(+4)</div>':0==ele23.ans.length?dE("tt_marksaward").innerHTML='<div style="color:orange">Unanswered(0)</div>':dE("tt_marksaward").innerHTML='<div style="color:red">Incorrect(-1)</div>')}if(0==fghu){for(var fghut=0,k=0;k<testResponseList.length;k++)testResponseList[k].qid==activequestionid&&(testResponseList[k].type="tts_notanswer",testResponseList[k].ans=[],fghut=1,dE(activequestionid).classList.remove("tts_notanswer","tts_notvisit","tts_answered","tts_review","tts_ansreview"),dE(activequestionid).classList.add("tts_notanswer"));0==fghut&&testResponseList.push({qid:activequestionid,ans:[],type:"tts_notanswer"})}break}}function inittestHandler(){var a=1;dE("tw_Physics").innerHTML="",dE("tw_Chemistry").innerHTML="",dE("tw_Math").innerHTML="",dE("tw_Computer").innerHTML="",dE("tw_Statistics").innerHTML="",dE("tw_Biology").innerHTML="",dE("tw_Unfiled").innerHTML="";for(let ele of testQuestionList.questions){var box='<span class = "tts_notvisit" id = "'+ele.qid+'">'+a+"</span>";a+=1,dE("tw_"+ele.section).insertAdjacentHTML("beforeend",box),dE(ele.qid).addEventListener("click",tqH)}if(!window.location.hash.includes("attempt")){for(let ele23 of testResponseList){var id=ele23.qid;for(let ele of testReportAnswers.questions)if(id==ele.qid){var tyio=ele.answer;null==ele23.ans&&(ele23.ans=[]),areEqual(ele23.ans,tyio)?dE(id).classList.add("t_crr"):0==ele23.ans.length?dE(id).classList.add("t_unat"):dE(id).classList.add("t_incrr")}}analyseActions(2)}for(let ele of testResponseList)dE(ele.qid).classList.replace("tts_notvisit",ele.type);testqHandler(testQuestionList.questions[0].qid,1)}async function testOperator(type){if(!window.location.hash.includes("attempt"))return log("Error","Performing Test Operations in Test Reports Is Prohibited"),1;var aqid="answers."+activequestionid,testid=window.location.hash.split("#/attempt/")[1],triu=dE("qb_q_ty").innerText.split("(")[1];if("tts_notanswer"==type){await updateDoc(doc(db,"tests",testid,"responses",auth.currentUser.uid),{[`${aqid}`]:{ans:"",type:"tts_notanswer",time:serverTimestamp()}});var a=0;for(let ele23 of testResponseList){if(ele23.qid==activequestionid){for(var i=0;i<document.getElementsByClassName("q_ans").length;i++){var ele32=document.getElementsByClassName("q_ans")[i];if("mcq"==triu||"mcq_multiple"==triu)for(var j=0;j<ele23.ans.length;j++){var ele44=ele23.ans[j];ele32.value==ele44&&(ele32.checked=!1)}else ele23.value=""}testResponseList.splice(a,1)}a+=1}}else{for(var ans=[],i=0;i<document.getElementsByClassName("q_ans").length;i++){var ele32=document.getElementsByClassName("q_ans")[i];"mcq)"==triu||"mcq_multiple)"==triu?1==ele32.checked&&ans.push(ele32.value):ans.push(ele32.value)}"tts_review"==type&&(ans=""),await updateDoc(doc(db,"tests",testid,"responses",auth.currentUser.uid),{[`${aqid}`]:{ans:ans,type:type,time:serverTimestamp()}});var eleexists=0;for(let ele of testResponseList)ele.qid==activequestionid&&(ele.ans=ans,ele.type=type,eleexists=1);0==eleexists&&testResponseList.push({qid:activequestionid,ans:ans,type:type})}dE(activequestionid).classList.remove("tts_notanswer","tts_notvisit","tts_answered","tts_review","tts_ansreview"),dE(activequestionid).classList.add(type)}async function submitTest(){if(!window.location.hash.includes("attempt"))return log("Error","Performing Test Operations in Test Reports Is Prohibited"),1;var testid=window.location.hash.split("#/attempt/")[1];window.onbeforeunload=function(){},window.onhashchange=locationHandler,await updateDoc(doc(db,"tests",testid,"responses",auth.currentUser.uid),{endon:serverTimestamp(),actions:testActionLogger,warning:[]}),await updateDoc(doc(db,"tests",testid,"responses","finished"),{finished:arrayUnion(auth.currentUser.uid)}).then(computeResult(0));var endat=new Date(1e3*testInfo.endon.seconds);dE("te_endtime").innerText=endat,testList=[],activeTestList=[],upcomingTestList=[],finishedTestList=[],testInfo=[],testQuestionList=[],testResponseList=[],activequestionid="",dE("dsh_btn").style.display="block",dE("tp_pnt").style.display="none"}function internetStatus(type){1==type?(document.getElementById("msg_popup").style.visibility="hidden",document.getElementById("msg_popup").style.opacity="0"):0==type&&log("WARNING","You Are Currently Offline.")}function defineEvents(){function chItem(){changeItem(1)}function simHand(){changeLocationHash("simlist",1)}function cybHand(){changeLocationHash("cyberhunt",1)}function abtHand(){changeLocationHash("about",1)}function tmtHand(){changeLocationHash("timetable",1)}function regHand(){changeLocationHash("register",1)}function prfHand(){changeLocationHash("profile",1)}function dshHand(){changeLocationHash("dashboard",1)}function adiHand(){changeLocationHash("functions",1)}function tstinfHand(){changeLocationHash("testinfo",1)}function uscHand(){changeLocationHash("users",1)}function tpcHand(){changeLocationHash("tpclist",1)}function lvqHand(){changeLocationHash("livequiz",1)}function frmHand(){changeLocationHash("forum",1)}function lglHand(){changeLocationHash("legal",1)}function qbaHand(){changeLocationHash("qblist",1)}function chpHand(){changeLocationHash("chplist",1)}function sTestHand(){t_log("Warning","Are You Sure You Want To End The Test",submitTest,"Yes,Submit")}function prvHand(){topicHandler(1)}function nxtHand(){topicHandler(2)}function actHand(){renderTestList("active")}function upcHand(){renderTestList("upcoming")}function finHand(){renderTestList("finished")}function qbnkend(){dE("watermark").style.display="flex",fullEle(dE("qbnk_vid"))}function qbnkstr(){prepareVideo()}function tsave(){testOperator("tts_answered")}function tclear(){testOperator("tts_notanswer")}function treview(){testOperator("tts_review")}function tansrev(){testOperator("tts_ansreview")}function psims(){getSimList("physics")}function csims(){getSimList("chemistry")}function msims(){getSimList("maths")}function bsims(){getSimList("biology")}function cosims(){getSimList("computer")}function ssims(){getSimList("statistics")}function usims(){getSimList("unfiled")}function pchb(){renderCList("physics")}function cchb(){renderCList("chemistry")}function mchb(){renderCList("maths")}function bchb(){renderCList("biology")}function cochb(){renderCList("computer")}function schb(){renderCList("statistics")}function uchb(){renderCList("unfiled")}function uQL(){updateTopicQBank(1)}function uQL2(){updateTopicQBank(2)}function uQL3(){updateTopicQBank(3)}function uQL4(){updateTopicQBank(4)}function rgbtn(){log("Note","By Clicking on 'Accept And Register' you agree that you accept all Terms And Conditions and Privacy Policy of Quarkz!",signUp,"Accept And Register")}var simbtn=dE("sim_btn").addEventListener("click",simHand),sgnbtn=dE("sgn_in").addEventListener("click",signIn),regbtn=dE("reg_in").addEventListener("click",regHand),rgbtn=dE("rg_in").addEventListener("click",rgbtn),sgnout=dE("lgt_btn").addEventListener("click",signOutUser),tmtbtn=dE("tmt_btn").addEventListener("click",tmtHand),prfbtn=dE("prf_btn").addEventListener("click",prfHand),abtbtn=dE("abt_btn").addEventListener("click",abtHand),shfbtn=dE("shf_btn").addEventListener("click",shuffleQBank),aqao=dE("aq_ao").addEventListener("click",addMCQ),aqro=dE("aq_ro").addEventListener("click",removeMCQ),aqre=dE("aq_re").addEventListener("click",removeEntry),tmode=dE("aq_mode").addEventListener("change",changeItem),ttype=dE("aq_type").addEventListener("change",changeItem),dshbtn=dE("dsh_btn").addEventListener("click",dshHand),adibtn=dE("adi_btn").addEventListener("click",adiHand),aqsave=dE("aq_tpc_save").addEventListener("click",uQL),aqsave=dE("aq_qbc_save").addEventListener("click",uQL2),aqsave=dE("aq_tst_save").addEventListener("click",uQL3),aqsave=dE("aq_exam_save").addEventListener("click",uQL4),unsave=dE("un_save").addEventListener("click",unotes1),unprint=dE("un_print").addEventListener("click",unotes2),tstinfbtn=dE("tstinf_btn").addEventListener("click",tstinfHand),tpcbtn=dE("tpc_btn").addEventListener("click",tpcHand),uscbtn=dE("usc_btn").addEventListener("click",uscHand),lvqbtn=dE("lvq_btn").addEventListener("click",lvqHand),frmbtn=dE("frm_btn").addEventListener("click",frmHand),tpnxt=dE("tp_nxt").addEventListener("click",nxtHand),tpprv=dE("tp_prv").addEventListener("click",prvHand),tpsbm=dE("tp_sbm").addEventListener("click",checkQuestion),lglbtn=dE("lgl_btn").addEventListener("click",lglHand),qbabtn=dE("qba_btn").addEventListener("click",qbaHand),tppnt=dE("tp_pnt").addEventListener("click",printStuff),tppnt=dE("aq_export").addEventListener("click",printStuff),tpedt=dE("tp_edt").addEventListener("click",editStuff),cybbtn=dE("cyb_btn").addEventListener("click",cybHand),tiact=dE("ti_act").addEventListener("click",actHand),tiupc=dE("ti_upc").addEventListener("click",upcHand),tifin=dE("ti_fin").addEventListener("click",finHand),tt_save=dE("tt_save").addEventListener("click",tsave),tt_clear=dE("tt_clear").addEventListener("click",tclear),tt_review=dE("tt_review").addEventListener("click",treview),tt_ansreview=dE("tt_ansreview").addEventListener("click",tansrev),p_sims=dE("psims").addEventListener("click",psims),c_sims=dE("csims").addEventListener("click",csims),m_sims=dE("msims").addEventListener("click",msims),b_sims=dE("bsims").addEventListener("click",bsims),co_sims=dE("cosims").addEventListener("click",cosims),s_sims=dE("ssims").addEventListener("click",ssims),u_sims=dE("usims").addEventListener("click",usims),p_chb=dE("pchb").addEventListener("click",pchb),c_chb=dE("cchb").addEventListener("click",cchb),m_chb=dE("mchb").addEventListener("click",mchb),b_chb=dE("bchb").addEventListener("click",bchb),co_chb=dE("cochb").addEventListener("click",cochb),s_chb=dE("schb").addEventListener("click",schb),u_chb=dE("uchb").addEventListener("click",uchb),ttsub=dE("tt_sub").addEventListener("click",sTestHand),chp_btn=dE("chp_btn").addEventListener("click",chpHand),pass_rst_btn=dE("pass_rst_btn").addEventListener("click",requestPasschange),aq_sims_save=dE("aq_sims_save").addEventListener("click",updateSimulationWeb);dE("un_print").addEventListener("click",(function(){dE("un_preview").style.display="block",dE("un_preview").innerHTML="<h1 style = 'text-align:center;margin:0px'>"+dE("un_title").value+"</h1><br>"+getHTML("un_editable"),window.idElementPrint(dE("un_preview"),userinfo.name)})),dE("qbnk_vid_btn_e").addEventListener("click",qbnkend),dE("qbnk_vid_btn").addEventListener("click",qbnkstr)}function plyVid(){window.player.playVideo()}function stpVid(){try{window.player.stopVideo()}catch{}}function pauVid(){window.player.pauseVideo()}function loadVid(videoId){window.player.loadVideoById(videoId)}function getHTM(id){return window.getHTML(id)}function setHTM(id,html){window.setHTML(id,html)}function renderAppInfo(){dE("ren_appinf").textContent=JSON.stringify(Quarkz,void 0,2)}function immersiveMode(){}gtMsg(),getPinned(),window.onbeforeunload=function(event){updatePoints()},window.addEventListener("online",()=>internetStatus(1)),window.addEventListener("offline",()=>internetStatus(0)),dE("te_title").innerText="The Test Has Ended";var Quarkz={copyright:"Mr Techtroid 2021-23",vno:"v0.2.1",author:"Mr Techtroid","last-updated":"05/01/2023(IST)",serverstatus:"firebase-online"},handlebox="login",location1=window.location.hash.split("#/")[1],userinfo,topicJSON={},topicJSONno=0,editorrole,adminrole,userrole,topiclist=[],qlist=[],simlist=[],chapterlist=[],userdetails=[],curr_qlno=0,curr_qlid="",editqllist=[],autosignin=0,testList=[],activeTestList=[],upcomingTestList=[],finishedTestList=[],testInfo=[],testQuestionList=[],testResponseList=[],activequestionid="",testActionLogger=[],testReportAnswers=[],reQW,analysedActions;window.onhashchange=locationHandler,initFirebaseAuth(),defineEvents(),sysaccess();